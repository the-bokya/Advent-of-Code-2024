Rewrite using a DP solution
